Integração Snort & Wazuh para Alerta Crítico CustomizadoEste projeto demonstra a capacidade de integrar um Intrusion Detection System (IDS) como o Snort com uma plataforma Security Information and Event Management (SIEM) como o Wazuh (em ambiente Docker), criando um alerta de alta severidade (Nível 12) a partir de um evento de rede específico.1.  Arquitetura e Fluxo de LogO log de alerta foi gerado pelo Snort no Host e lido pelo Wazuh Manager, que aplicou a regra customizada:Snort: Gera o alerta de ICMP no arquivo /var/log/snortlog/alert.Wazuh Logcollector: Lê o arquivo em tempo real.Wazuh Analysisd: Sobrescreve a regra genérica com a customizada (rule.id: 100002).Wazuh Indexer/Dashboard: Exibe o alerta com Nível 12.2.  Configuração da Fonte de DadosO primeiro passo foi garantir que o Wazuh Manager estivesse lendo o arquivo de alerta do Snort, que gerava a Signature ID (SID) 1000001.A. Inclusão no Logcollector (/var/ossec/etc/ossec.conf)Adição da diretiva para leitura do log do Snort:XML<localfile>
  <log_format>snort-full</log_format>
  <location>/var/log/snortlog/alert</location>
</localfile>
B. Log Bruto Capturado (Prova de SID)A SID exata que o Wazuh deveria buscar (confirmada via sudo tail):Snippet de código[**] [1:1000001:1] [TEST] PING ICMP Detected [**]
[Priority: 0]
12/03-15:14:30.199373 10.0.0.112 -> 8.8.8.8
3. Solução Final: Regra de SobrescritaO Wazuh estava aplicando a regra genérica de IDS (rule.id: 20101) ao invés de usar a customizada. A solução foi criar uma regra de sobrescrita robusta que força o match na SID do Snort dentro da regra genérica.Regra em /var/ossec/etc/rules/local_rules.xmlXML<group name="snort,">
   <rule id="100002" level="12" overwrite="yes"> 
    <if_sid>20101</if_sid> 
    <match>1:1000001:1</match> 
    <description>SNORT: SUCESSO! ALERTA CRÍTICO DE ICMP - PROJETO CONCLUÍDO!</description>
   </rule>
</group>
4. Desafios Superados (Troubleshooting)Este projeto demonstrou expertise em resolução de problemas críticos de infraestrutura e segurança:DesafioCausa RaizSolução PráticaFalha Crítica de Comunicação (AxiosError / ECONNREFUSED)Sockets UNIX do wazuh-db presos dentro do container Manager.Remoção dos arquivos de socket (rm -f /var/ossec/queue/db/wdb) e restart do Manager.Erros de Sintaxe no XMLConflitos de tags (<decoders>, <type>) no local_decoder.xml que impediam a inicialização do wazuh-analysisd.Limpeza e simplificação do arquivo de decodificador.Falha na Aplicação da RegraRegra customizada não era aplicada; a genérica 20101 prevalecia.Implementação de uma regra de Sobrescrita Forçada (overwrite="yes") usando if_sid: 20101 combinado com o match da SID do Snort.5. ✅ Resultado Final no DashboardO alerta customizado foi indexado com sucesso, provando a eficácia da integração e das regras de análise.
